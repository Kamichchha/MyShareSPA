(function(){angular.module("myShareApp",["ngRoute","ui.bootstrap","ngResource"]);var e=function(e,t){e.when("/",{templateUrl:"/home/home.view.html",controller:"stockListCtrl",controllerAs:"stockListVM"}).when("/stock/:stockId",{templateUrl:"/stock/stock-details.view.html",controller:"stockDetailsCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/about/about.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/feedback",{templateUrl:"/feedback/feedback.list.html",controller:"feedbackListCtrl",controllerAs:"feedbackListVM"}).otherwise({redirectTo:"/"});t.html5Mode(true)};angular.module("myShareApp").config(["$routeProvider","$locationProvider",e])})();(function(){e.$inject=["$scope","stockService","getLocationService","$uibModal","authentication"];function e(e,t,o,a,r){stockListVM=this;stockListVM.message="Loading stocks list";stockListVM.pageHeader={title:"MyShare",strapLine:"    Ideas that can change your life..."};stockListVM.isLoggedIn=r.isLoggedIn();stockListVM.loadData=function(){t.getData().then(function(e){stockListVM.stockList=e.data;stockListVM.message=e.data.length>0?"":"No stocks found."},function(e){stockListVM.message="Something went wrong!!!"})};stockListVM.loadData();stockListVM.addStockForm=function(){var e=a.open({templateUrl:"stock/add-stock.modal.html",controller:"addStockCtrl",controllerAs:"vm",size:"lg"});e.result.then(function(e){stockListVM.stockList.push(e)})};stockListVM.updateStockForm=function(e){var t=a.open({templateUrl:"stock/update-stock.modal.html",controller:"updateStockCtrl",controllerAs:"vm",size:"lg",resolve:{updateData:function(){return{stockId:e}}}});t.result.then(function(e){stockListVM.loadData()})};stockListVM.deleteStock=function(e){t.deleteStock(e).success(function(){stockListVM.loadData()}).error(function(e){console.log(e)})};stockListVM.loadLocation=function(t){e.$apply(function(){stockListVM.locMessage="You'r at : "+t.coords.latitude+" ,"+t.coords.longitude})};stockListVM.errorLocation=function(t){e.$apply(function(){stockListVM.locMessage=""})};stockListVM.noLocation=function(){e.$apply(function(){stockListVM.locMessage="Browser doesn't support geolocation"})}}angular.module("myShareApp").controller("stockListCtrl",e)})();(function(){e.$inject=["authentication","$location"];function e(e,t){var o=this;o.credentials={name:"",email:"",password:""};o.pageHeader={title:"Register User"};o.returnPage=t.search().page||"/";o.addUser=function(){o.error="";if(!o.credentials.name||!o.credentials.email||!o.credentials.password){o.error="All fields required, try again.";return false}var a={name:o.credentials.name,email:o.credentials.email,password:o.credentials.password};e.register(a).success(function(e){t.search("page",null);t.path(o.returnPage)}).error(function(e){o.error=e.message})}}angular.module("myShareApp").controller("registerCtrl",e)})();(function(){e.$inject=["authentication","$location"];function e(e,t){var o=this;o.credentials={email:"",password:""};o.error="";o.pageHeader={title:"Log In"};o.returnPage=t.search().page||"/";o.loginUser=function(){o.error="";if(!o.credentials.email||!o.credentials.password){o.error="All fields required, try again.";return false}var a={email:o.credentials.email,password:o.credentials.password};e.login(a).success(function(e){t.search("page",null);t.path(o.returnPage)}).error(function(e){o.error=e.message.message})}}angular.module("myShareApp").controller("loginCtrl",e)})();(function(){e.$inject=["$window","$http"];function e(e,t){var o=function(t){e.localStorage["authToken"]=t};var a=function(){return e.localStorage["authToken"]};var r=function(e){return t.post("/api/login",e).success(function(e){o(e.token)})};var n=function(e){return t.post("/api/register",e).success(function(e){o(e.token)})};var c=function(){e.localStorage.removeItem("authToken")};var i=function(){var t=a();if(t){var o=JSON.parse(e.atob(t.split(".")[1]));return o.exp>Date.now()/1e3}else return false};var s=function(){if(i()){var t=this.getToken();var o=JSON.parse(e.atob(t.split(".")[1]));return{name:o.name,email:o.email}}};return{getToken:a,saveToken:o,login:r,logout:c,currentUser:s,isLoggedIn:i,register:n}}angular.module("myShareApp").factory("authentication",e)})();(function(){var e={sectors:["Automobiles","Banking","Capital Goods","Finance","Infrastructure","IT Sector","Mining","Pharmaceuticals","Textiles"],industries:["Large-cap","Mid-cap","Small-cap"]};angular.module("myShareApp").value("descriptions",e)})();(function(){e.$inject=["authentication","$location"];function e(e,t){var o=this;o.currentPath=t.path();o.isLoggedIn=e.isLoggedIn();o.currentUser=e.currentUser();o.logOut=function(){e.logout();t.path("/login")}}angular.module("myShareApp").controller("navigationCtrl",e)})();(function(){e.$inject=["stockService","$uibModal","$routeParams","authentication"];function e(e,t,o,a){vm=this;vm.stockId=o.stockId;vm.pageHeader={title:""};vm.isLoggedIn=a.isLoggedIn();e.getStockById(vm.stockId).success(function(e){vm.stock=e;vm.pageHeader.strapLine="Stock Details for "+vm.stock.stockName}).error(function(e){console.log(e)});vm.popUpReviewForm=function(){var e=t.open({templateUrl:"review/add-review.modal.html",controller:"addReviewModalCtrl",controllerAs:"vm",resolve:{stockData:function(){return{stockId:vm.stockId,stockName:vm.stock.stockName}}}});e.result.then(function(e){vm.stock.reviews.push(e)})};vm.content={title:"About Us",data:"    Ideas that can change your life..."}}angular.module("myShareApp").controller("stockDetailsCtrl",e)})();(function(){e.$inject=["stockService","$uibModalInstance","descriptions"];function e(e,t,o){var a=this;a.descriptions=o;a.addStock=function(){a.error="";a.stockData={stockName:a.stockName,stockCode:a.stockCode,volume:a.volume,currPrice:a.currPrice,wkHigh52:a.wk52High,wkLow52:a.wk52Low};a.stockData.category=[];if(a.industry!==null){a.stockData.category.push(a.industry)}if(a.sector!==null){a.stockData.category.push(a.sector)}e.addStock(a.stockData).success(function(e){t.close(e);return false}).error(function(e){a.error="Error saving stock, please try again";return false})};a.onCancel=function(){t.dismiss("cancel")}}angular.module("myShareApp").controller("addStockCtrl",e)})();(function(){e.$inject=["stockService","updateData","$uibModalInstance","descriptions"];function e(e,t,o,a){var r=this;r.stockId=t.stockId;r.descriptions=a;e.getStockById(r.stockId).success(function(e){r.stockData=e;r.stockData.industry=e.category[0];r.stockData.sector=e.category[1]}).error(function(e){console.log(e)});r.onUpdate=function(){r.error="";r.updatedData={stockName:r.stockData.stockName,stockCode:r.stockData.stockCode,volume:r.stockData.volume,currPrice:r.stockData.currPrice,wkHigh52:r.stockData.wkHigh52,wkLow52:r.stockData.wkLow52};r.updatedData.category=[];r.updatedData.category.push(r.stockData.industry);r.updatedData.category.push(r.stockData.sector);e.updateStock(r.stockId,r.updatedData).success(function(e){o.close(e);return false}).error(function(e){r.error="Error updating stock, please try again";return false})};r.onCancel=function(){o.dismiss("cancel")}}angular.module("myShareApp").controller("updateStockCtrl",e)})();(function(){e.$inject=["FeedbackService","$uibModalInstance"];function e(e,t){var o=this;o.addItem=function(){o.error="";o.feedback=new e;o.feedback={headline:o.headline,description:o.description,status:o.status};e.save(o.feedback,function(e){t.close(e);return false})};o.onCancel=function(){t.dismiss("cancel")}}angular.module("myShareApp").controller("addFeedBackCtrl",e)})();(function(){e.$inject=["FeedbackService","$uibModalInstance","updateFeedback"];function e(e,t,o){var a=this;a.feedBackId=o.feedBackId;var r=e.get({feedBackId:a.feedBackId},function(){a.feedback=r});a.updateItem=function(){a.error="";r.headline=a.feedback.headline;r.description=a.feedback.description;r.status=a.feedback.status;r.$update(function(){t.close();return false})};a.onCancel=function(){t.dismiss("cancel")}}angular.module("myShareApp").controller("updateFeedBackCtrl",e)})();(function(){e.$inject=["$scope","FeedbackService","$uibModal"];function e(e,t,o){feedbackListVM=this;feedbackListVM.message="Loading Feedback list";feedbackListVM.pageHeader={title:"FeedBacks",strapLine:""};feedbackListVM.LoadData=function(){feedbackListVM.feedBackList=t.query(function(){feedbackListVM.message=""})};feedbackListVM.LoadData();feedbackListVM.addFeedBackForm=function(){var e=o.open({templateUrl:"feedback/add-feedback.modal.html",controller:"addFeedBackCtrl",controllerAs:"vm",size:"lg"});e.result.then(function(e){feedbackListVM.feedBackList.push(e)})};feedbackListVM.updateFeedBackForm=function(e){var t=o.open({templateUrl:"feedback/update-feedback.modal.html",controller:"updateFeedBackCtrl",controllerAs:"vm",size:"lg",resolve:{updateFeedback:function(){return{feedBackId:e}}}});t.result.then(function(){feedbackListVM.LoadData()})};feedbackListVM.deleteFeedback=function(e){t.remove({feedBackId:e},function(){feedbackListVM.LoadData()})}}angular.module("myShareApp").controller("feedbackListCtrl",e)})();(function(){function e(){vm=this;vm.pageHeader={title:"About Us"};vm.content={data:"    Ideas that can change your life..."}}angular.module("myShareApp").controller("aboutCtrl",e)})();(function(){e.$inject=["$uibModalInstance","stockData","stockService","authentication"];function e(e,t,o,a){var r=this;r.stockData=t;r.formData={};r.formData.name=a.currentUser().name;r.onSubmit=function(){r.formData.error="";if(!r.formData.name||!r.formData.comment){r.formData.error="All fields required, please try again";return false}else{r.saveData(r.stockData.stockId,r.formData);return false}};r.modal={cancel:function(){e.dismiss("cancel")},close:function(t){e.close(t)}};r.saveData=function(e,t){o.addReviewById(e,{author:t.name,comment:t.comment}).success(function(e){r.modal.close(e)}).error(function(e){r.formData.error="Error saving review, please try again"})}}angular.module("myShareApp").controller("addReviewModalCtrl",e)})();(function(){var e=function(){var e=function(e,t,o){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,t)}else{o()}};return{getLocData:e}};angular.module("myShareApp").service("getLocationService",e)})();(function(){e.$inject=["$http","authentication"];function e(e,t){var o=function(){return e.get("/api/stock",{headers:{Authorization:"Bearer "+t.getToken()}})};var a=function(o){return e.get("/api/stock/"+o,{headers:{Authorization:"Bearer "+t.getToken()}})};var r=function(o,a){return e.post("/api/stock/"+o+"/comment",a,{headers:{Authorization:"Bearer "+t.getToken()}})};var n=function(o){return e.post("/api/stock",o,{headers:{Authorization:"Bearer "+t.getToken()}})};var c=function(o,a){return e.put("/api/stock/"+o,a,{headers:{Authorization:"Bearer "+t.getToken()}})};var i=function(o){return e.delete("/api/stock/"+o,{headers:{Authorization:"Bearer "+t.getToken()}})};return{getData:o,getStockById:a,addReviewById:r,addStock:n,updateStock:c,deleteStock:i}}angular.module("myShareApp").service("stockService",e)})();(function(){e.$inject=["$resource"];function e(e){return e("/api/feedback/:feedBackId",{feedBackId:"@_id"},{update:{method:"PUT"}})}angular.module("myShareApp").factory("FeedbackService",e)})();(function(){var e=function(){return function(e){var t=e.toString();if(t.length<=3){return e}e=t.substring(0,t.length-3)+","+t.substring(t.length-3);return e}};angular.module("myShareApp").filter("formatVolume",e)})();(function(){var e=function(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader.html"}};angular.module("myShareApp").directive("pageHeader",e)})();(function(){var e=function(){return{restrict:"EA",templateUrl:"/common/directives/myShareNavigation.html",controller:"navigationCtrl as navvm"}};angular.module("myShareApp").directive("navigation",e)})();(function(){var e=function(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric.html"}};angular.module("myShareApp").directive("footerGeneric",e)})();